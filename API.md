# API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –ë–∞–∑–æ–≤—ã–π URL
```
http://localhost:3001/api
```

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:
```
Authorization: Bearer {token}
```

–¢–æ–∫–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `POST /auth/join/:token` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage.

---

## –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### POST /auth/join/:token
–°–æ–∑–¥–∞—ë—Ç –∏–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ invite_token –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `token` (path) - invite_token –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–û—Ç–≤–µ—Ç:**
```json
{
  "user": {
    "id": 1,
    "invite_token": "abc123...",
    "created_at": "2024-12-25T00:00:00.000Z",
    "total_completed_tasks": 0,
    "roulette_weight": 0,
    "has_spun_roulette": false
  },
  "token": "jwt_token_here"
}
```

---

## –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (—Ç—Ä–µ–±—É—é—Ç —Ç–æ–∫–µ–Ω)

### GET /auth/me
–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": 1,
  "invite_token": "abc123...",
  "created_at": "2024-12-25T00:00:00.000Z",
  "total_completed_tasks": 5,
  "roulette_weight": 5,
  "has_spun_roulette": false
}
```

### GET /tasks/today
–ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.

**–û—Ç–≤–µ—Ç:**
```json
{
  "day": 1,
  "tasks": [
    {
      "id": 1,
      "day_number": 1,
      "title": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è",
      "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
      "input_type": "text",
      "order": 1,
      "is_completed": false
    }
  ]
}
```

### POST /tasks/:id/submit
–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞–Ω–∏–µ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (path) - ID –∑–∞–¥–∞–Ω–∏—è

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "text_answer": "–ú–æ–π –æ—Ç–≤–µ—Ç",
  "media_url": "/uploads/photo.jpg"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!"
}
```

### GET /progress
–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–û—Ç–≤–µ—Ç:**
```json
{
  "total_completed_tasks": 5,
  "days_participated": 3,
  "roulette_weight": 5
}
```

### GET /roulette/status
–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ä—É–ª–µ—Ç–∫–∏.

**–û—Ç–≤–µ—Ç:**
```json
{
  "available": true,
  "has_spun": false,
  "roulette_weight": 5
}
```

### POST /roulette/spin
–ö—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É (–æ–¥–∏–Ω —Ä–∞–∑).

**–û—Ç–≤–µ—Ç:**
```json
{
  "prize_type": "main",
  "message": "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –¢—ã –≤—ã–∏–≥—Ä–∞–ª –≥–ª–∞–≤–Ω—ã–π –ø—Ä–∏–∑!"
}
```

### GET /final
–ü–æ–ª—É—á–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–æ—Å–ª–µ —Ä—É–ª–µ—Ç–∫–∏).

**–û—Ç–≤–µ—Ç:**
```json
{
  "text_submissions": [...],
  "photo_submissions": [...],
  "winner": {
    "id": 1,
    "invite_token": "...",
    "prize_type": "main"
  }
}
```

### POST /upload
–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª (—Ñ–æ—Ç–æ).

**–§–æ—Ä–º–∞—Ç:** multipart/form-data
**–ü–æ–ª–µ:** `file`

**–û—Ç–≤–µ—Ç:**
```json
{
  "url": "/uploads/1234567890-photo.jpg"
}
```

---

## –ê–¥–º–∏–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (—Ç—Ä–µ–±—É—é—Ç x-admin-token)

–í—Å–µ –∞–¥–º–∏–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫:
```
x-admin-token: {admin_token}
```

### GET /admin/tasks
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è.

### POST /admin/tasks
–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "day_number": 1,
  "title": "–ù–∞–∑–≤–∞–Ω–∏–µ",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
  "input_type": "text",
  "order_number": 1,
  "is_active": true
}
```

### PUT /admin/tasks/:id
–û–±–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ.

### DELETE /admin/tasks/:id
–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ.

### GET /admin/submissions
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### GET /admin/users
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### PUT /admin/users/:id/weight
–ò–∑–º–µ–Ω–∏—Ç—å roulette_weight –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "roulette_weight": 10
}
```

### GET /admin/roulette/winner
–ü–æ–ª—É—á–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è —Ä—É–ª–µ—Ç–∫–∏.

### POST /admin/comments
–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "user_id": 1,
  "comment": "–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!"
}
```

### POST /admin/upload
–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª (–¥–ª—è –∞–¥–º–∏–Ω–∞).

---

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

- `400` - –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω
- `404` - –ù–µ –Ω–∞–π–¥–µ–Ω–æ
- `500` - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

